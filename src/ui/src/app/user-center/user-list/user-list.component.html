<div class="clr-row flex-items-xs-right">
  <button *ngIf="authMode === 'db_auth'" class="btn btn-primary"
          (click)="addUser()">{{'USER_CENTER.ADD_USER' | translate}}</button>
  <new-user *ngIf="showNewUser"
            [CurEditModel]="curEditModel"
            [userModel]="curUser"
            [(isOpen)]="showNewUser"
            (SubmitSuccessEvent)="refreshData(oldStateInfo)">
  </new-user>
</div>
<clr-datagrid (clrDgRefresh)="refreshData($event)" [clrDgLoading]="isInLoading">
  <clr-dg-placeholder>{{userListErrMsg | translate}}</clr-dg-placeholder>
  <clr-dg-column [clrDgField]="'NAME'"
                 [clrDgSortOrder]="descSort">
    <clr-dg-filter [hidden]="true"></clr-dg-filter>
    {{'USER_CENTER.LIST_COL_USERNAME' | translate}}
  </clr-dg-column>
  <clr-dg-column>{{'USER_CENTER.LIST_COL_EMAIL' | translate}}</clr-dg-column>
  <clr-dg-column [clrDgField]="'CREATION_TIME'" [clrDgSortOrder]="descSort">
    <clr-dg-filter [hidden]="true"></clr-dg-filter>
    {{'USER_CENTER.LIST_COL_CREATE_DATE' | translate}}
  </clr-dg-column>
  <clr-dg-column>{{'USER_CENTER.LIST_COL_SYSTEM_ADMIN' | translate}}</clr-dg-column>
  <clr-dg-column>{{'USER_CENTER.LIST_COL_DELETE' | translate}}</clr-dg-column>
  <clr-dg-column>{{'USER_CENTER.LIST_COL_OPERATION' | translate}}</clr-dg-column>
  <clr-dg-row *ngFor="let user of userListData">
    <clr-dg-cell class="text-with-omit">{{user.user_name}}</clr-dg-cell>
    <clr-dg-cell>{{user.user_email}}</clr-dg-cell>
    <clr-dg-cell>{{user.user_creation_time | date:'short'}}</clr-dg-cell>
    <clr-dg-cell>
      <input type="checkbox"
             [disabled]="setUserSystemAdminWIP || user.user_id == currentUserID || user.user_deleted == 1"
             [checked]="user.user_system_admin"
             (change)="setUserSystemAdmin(user,$event)">
    </clr-dg-cell>
    <clr-dg-cell>
      <input type="checkbox"
             [disabled]="true" [checked]="user.user_deleted == 1">
    </clr-dg-cell>
    <clr-dg-cell>
      <clr-icon [ngClass]="{'disabled': user.user_deleted == 1 ||  user.user_id == 1 || user.user_id == currentUserID}"
                (click)="deleteUser(user)"
                class="trash"
                shape="trash">
      </clr-icon>
      <clr-icon *ngIf="authMode === 'db_auth'"
                [ngClass]="{'disabled': user.user_deleted == 1 ||  user.user_id == 1 || user.user_id == currentUserID}"
                (click)="editUser(user)"
                class="edit"
                shape="edit">
      </clr-icon>
    </clr-dg-cell>
  </clr-dg-row>
  <clr-dg-footer>
    {{pagination.firstItem + 1}} - {{pagination.lastItem + 1}} of {{pagination.totalItems}} users
    <clr-dg-pagination #pagination [clrDgTotalItems]="totalRecordCount" [(clrDgPage)]="pageIndex"
                       [clrDgPageSize]="pageSize">
    </clr-dg-pagination>
  </clr-dg-footer>
</clr-datagrid>
